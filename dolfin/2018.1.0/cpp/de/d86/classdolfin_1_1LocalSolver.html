<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DOLFIN: dolfin::LocalSolver Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DOLFIN
   </div>
   <div id="projectbrief">DOLFIN C++ interface</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../df/de3/namespacedolfin.html">dolfin</a></li><li class="navelem"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html">LocalSolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../df/d91/classdolfin_1_1LocalSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dolfin::LocalSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Solve problems cell-wise.  
 <a href="../../de/d86/classdolfin_1_1LocalSolver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d6/d8a/LocalSolver_8h_source.html">LocalSolver.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ada2bcb038ea6523ffc972fc3cfb5da8f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ada2bcb038ea6523ffc972fc3cfb5da8f"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#ada2bcb038ea6523ffc972fc3cfb5da8f">SolverType</a> { <b>LU</b>, 
<b>Cholesky</b>
 }<tr class="memdesc:ada2bcb038ea6523ffc972fc3cfb5da8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">SolverType. <br /></td></tr>
</td></tr>
<tr class="separator:ada2bcb038ea6523ffc972fc3cfb5da8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaa2869d95565e605a3dd090d3a0dd8c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#aaa2869d95565e605a3dd090d3a0dd8c0">LocalSolver</a> (std::shared_ptr&lt; const <a class="el" href="../../d6/d5a/classdolfin_1_1Form.html">Form</a> &gt; a, std::shared_ptr&lt; const <a class="el" href="../../d6/d5a/classdolfin_1_1Form.html">Form</a> &gt; L, <a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#ada2bcb038ea6523ffc972fc3cfb5da8f">SolverType</a> solver_type=SolverType::LU)</td></tr>
<tr class="separator:aaa2869d95565e605a3dd090d3a0dd8c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2960d99fab4a9f5a2aa80f9825ecafd4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#a2960d99fab4a9f5a2aa80f9825ecafd4">LocalSolver</a> (std::shared_ptr&lt; const <a class="el" href="../../d6/d5a/classdolfin_1_1Form.html">Form</a> &gt; a, <a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#ada2bcb038ea6523ffc972fc3cfb5da8f">SolverType</a> solver_type=SolverType::LU)</td></tr>
<tr class="separator:a2960d99fab4a9f5a2aa80f9825ecafd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab44b99675997da19526758dcadbfef2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#aab44b99675997da19526758dcadbfef2">solve_global_rhs</a> (<a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> &amp;u) const </td></tr>
<tr class="separator:aab44b99675997da19526758dcadbfef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103c552d353920c8a9d8b5797c5f9ac6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#a103c552d353920c8a9d8b5797c5f9ac6">solve_local_rhs</a> (<a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> &amp;u) const </td></tr>
<tr class="separator:a103c552d353920c8a9d8b5797c5f9ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f5e25ef52c2d83e6f56ccbc697a422"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#a38f5e25ef52c2d83e6f56ccbc697a422">solve_local</a> (<a class="el" href="../../d6/da4/classdolfin_1_1GenericVector.html">GenericVector</a> &amp;x, const <a class="el" href="../../d6/da4/classdolfin_1_1GenericVector.html">GenericVector</a> &amp;b, const <a class="el" href="../../dd/dc3/classdolfin_1_1GenericDofMap.html">GenericDofMap</a> &amp;dofmap_b) const </td></tr>
<tr class="separator:a38f5e25ef52c2d83e6f56ccbc697a422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398caba1503b48df5aa9a7d19d67e248"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a398caba1503b48df5aa9a7d19d67e248"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#a398caba1503b48df5aa9a7d19d67e248">factorize</a> ()</td></tr>
<tr class="memdesc:a398caba1503b48df5aa9a7d19d67e248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factorise the local LHS matrices for all cells and store in cache. <br /></td></tr>
<tr class="separator:a398caba1503b48df5aa9a7d19d67e248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06490cbf4762ade8a2ced19c50ac8371"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a06490cbf4762ade8a2ced19c50ac8371"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#a06490cbf4762ade8a2ced19c50ac8371">clear_factorization</a> ()</td></tr>
<tr class="memdesc:a06490cbf4762ade8a2ced19c50ac8371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset (clear) any stored factorizations. <br /></td></tr>
<tr class="separator:a06490cbf4762ade8a2ced19c50ac8371"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Solve problems cell-wise. </p>
<p>This class solves problems cell-wise. It computes the local left-hand side A_local which must be square locally but not globally. The right-hand side b_local is either computed locally for one cell or globally for all cells depending on which of the solve_local_rhs or solve_global_rhs methods which are called. You can optionally assemble the right-hand side vector yourself and use the solve_local method. You must then provide the <a class="el" href="../../d7/daf/classdolfin_1_1DofMap.html" title="Degree-of-freedom map. ">DofMap</a> of the right-hand side.</p>
<p>The local solver solves A_local x_local = b_local. The result x_local is copied into the global vector x of the provided <a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> u. You can optionally call the <a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#a398caba1503b48df5aa9a7d19d67e248" title="Factorise the local LHS matrices for all cells and store in cache. ">factorize()</a> method to pre-calculate the local left-hand side factorizations to speed up repeated applications of the <a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html" title="Solve problems cell-wise. ">LocalSolver</a> with the same LHS. The solve_xxx methods will factorise the LHS A_local matrices each time if they are not cached by a previous call to factorize. You can chose upon initialization whether you want Cholesky or LU (default) factorisations.</p>
<p>For forms with no coupling across cell edges, this function is identical to a global solve. For problems with coupling across cells it is not.</p>
<p>This class can be used for post-processing solutions, e.g. computing stress fields for visualisation, far more cheaply that using global projections. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaa2869d95565e605a3dd090d3a0dd8c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LocalSolver::LocalSolver </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; const <a class="el" href="../../d6/d5a/classdolfin_1_1Form.html">Form</a> &gt;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; const <a class="el" href="../../d6/d5a/classdolfin_1_1Form.html">Form</a> &gt;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#ada2bcb038ea6523ffc972fc3cfb5da8f">SolverType</a>&#160;</td>
          <td class="paramname"><em>solver_type</em> = <code>SolverType::LU</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor (shared pointer version) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>(<a class="el" href="../../d6/d5a/classdolfin_1_1Form.html" title="Base class for UFC code generated by FFC for DOLFIN with option -l. ">Form</a>) input LHS form </td></tr>
    <tr><td class="paramname">L</td><td>(<a class="el" href="../../d6/d5a/classdolfin_1_1Form.html" title="Base class for UFC code generated by FFC for DOLFIN with option -l. ">Form</a>) input RHS form </td></tr>
    <tr><td class="paramname">solver_type</td><td>(SolverType) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2960d99fab4a9f5a2aa80f9825ecafd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LocalSolver::LocalSolver </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; const <a class="el" href="../../d6/d5a/classdolfin_1_1Form.html">Form</a> &gt;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d86/classdolfin_1_1LocalSolver.html#ada2bcb038ea6523ffc972fc3cfb5da8f">SolverType</a>&#160;</td>
          <td class="paramname"><em>solver_type</em> = <code>SolverType::LU</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor (shared pointer version) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>(<a class="el" href="../../d6/d5a/classdolfin_1_1Form.html" title="Base class for UFC code generated by FFC for DOLFIN with option -l. ">Form</a>) input LHS form </td></tr>
    <tr><td class="paramname">solver_type</td><td>(SolverType) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aab44b99675997da19526758dcadbfef2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocalSolver::solve_global_rhs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> &amp;&#160;</td>
          <td class="paramname"><em>u</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve local (cell-wise) problems A_e x_e = b_e, where A_e is the cell matrix LHS and b_e is the global RHS vector b restricted to the cell, i.e. b_e may contain contributions from neighbouring cells. The solution is exact for the case in which there is no coupling between cell contributions to the global matrix A, e.g. the discontinuous Galerkin matrix. The result is copied into x. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>(<a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a>&amp;) <a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a38f5e25ef52c2d83e6f56ccbc697a422"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocalSolver::solve_local </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classdolfin_1_1GenericVector.html">GenericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classdolfin_1_1GenericVector.html">GenericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dd/dc3/classdolfin_1_1GenericDofMap.html">GenericDofMap</a> &amp;&#160;</td>
          <td class="paramname"><em>dofmap_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve local problems for given RHS and corresponding dofmap for RHS </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>(<a class="el" href="../../d6/da4/classdolfin_1_1GenericVector.html" title="This class defines a common interface for vectors. ">GenericVector</a>) </td></tr>
    <tr><td class="paramname">b</td><td>(<a class="el" href="../../d6/da4/classdolfin_1_1GenericVector.html" title="This class defines a common interface for vectors. ">GenericVector</a>) </td></tr>
    <tr><td class="paramname">dofmap_b</td><td>(<a class="el" href="../../dd/dc3/classdolfin_1_1GenericDofMap.html" title="This class provides a generic interface for dof maps. ">GenericDofMap</a>) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a103c552d353920c8a9d8b5797c5f9ac6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LocalSolver::solve_local_rhs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> &amp;&#160;</td>
          <td class="paramname"><em>u</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve local (cell-wise) problems A_e x_e = b_e where A_e and b_e are the cell element tensors. Compared to solve_global_rhs this function calculates local RHS vectors for each cell and hence does not include contributions from neighbouring cells.</p>
<p>This function is useful for computing (approximate) cell-wise projections, for example for post-processing. It much more efficient than computing global projections. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>(<a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a>&amp;) <a class="el" href="../../d2/d42/classdolfin_1_1Function.html">Function</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/fenics/shared/dolfin/fem/<a class="el" href="../../d6/d8a/LocalSolver_8h_source.html">LocalSolver.h</a></li>
<li>/home/fenics/shared/dolfin/fem/LocalSolver.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
