

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>solve &mdash; FEniCS Project</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="FEniCS Project" href="../../../index.html"/>
        <link rel="up" title="dolfin.fem.solving module" href="index.html"/>
        <link rel="next" title="dolfin.fem.variationalproblem module" href="../variationalproblem/index.html"/>
        <link rel="prev" title="NonlinearVariationalSolver" href="NonlinearVariationalSolver.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> DOLFIN
          

          
          </a>

          
            
            
              <div class="version">
                1.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Programmer&#8217;s reference for DOLFIN (Python)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../common/index.html">dolfin.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../compilemodules/index.html">dolfin.compilemodules module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deprecation/index.html">dolfin.deprecation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/index.html">dolfin.cpp (Swig autogenerated module)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">dolfin.fem module</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../adaptivesolving/index.html">dolfin.fem.adaptivesolving module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../assembling/index.html">dolfin.fem.assembling module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bcs/index.html">dolfin.fem.bcs module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../errorcontrolgenerator/index.html">dolfin.fem.errorcontrolgenerator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../form/index.html">dolfin.fem.form module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../formmanipulations/index.html">dolfin.fem.formmanipulations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interpolation/index.html">dolfin.fem.interpolation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../norms/index.html">dolfin.fem.norms module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../projection/index.html">dolfin.fem.projection module</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">dolfin.fem.solving module</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="LinearVariationalProblem.html">LinearVariationalProblem</a></li>
<li class="toctree-l4"><a class="reference internal" href="LinearVariationalSolver.html">LinearVariationalSolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="NonlinearVariationalProblem.html">NonlinearVariationalProblem</a></li>
<li class="toctree-l4"><a class="reference internal" href="NonlinearVariationalSolver.html">NonlinearVariationalSolver</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">solve</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../variationalproblem/index.html">dolfin.fem.variationalproblem module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../functions/index.html">dolfin.functions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../importhandler/index.html">dolfin.importhandler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mesh/index.html">dolfin.mesh module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multistage/index.html">dolfin.multistage module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../demo/index.html">Collection of documented demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_reference.html">Quick Programmer&#8217;s Reference (Python)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">DOLFIN</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Programmer&#8217;s reference for DOLFIN (Python)</a> &raquo;</li>
      
          <li><a href="../index.html">dolfin.fem module</a> &raquo;</li>
      
          <li><a href="index.html">dolfin.fem.solving module</a> &raquo;</li>
      
    <li>solve</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/programmers-reference/fem/solving/solve.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="solve">
<span id="programmers-reference-fem-solving-solve"></span><h1>solve<a class="headerlink" href="#solve" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="dolfin.fem.solving.solve">
<code class="descclassname">dolfin.fem.solving.</code><code class="descname">solve</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#dolfin.fem.solving.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve linear system Ax = b or variational problem a == L or F == 0.</p>
<p>The DOLFIN solve() function can be used to solve either linear
systems or variational problems. The following list explains the
various ways in which the solve() function can be used.</p>
<p><em>1. Solving linear systems</em></p>
<p>A linear system Ax = b may be solved by calling solve(A, x, b),
where A is a matrix and x and b are vectors. Optional arguments
may be passed to specify the solver method and preconditioner.
Some examples are given below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;lu&quot;</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;gmres&quot;</span><span class="p">,</span> <span class="s2">&quot;ilu&quot;</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;cg&quot;</span><span class="p">,</span> <span class="s2">&quot;hypre_amg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Possible values for the solver method and preconditioner depend
on which linear algebra backend is used and how that has been
configured.</p>
<p>To list all available LU methods, run the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">list_lu_methods</span><span class="p">()</span>
</pre></div>
</div>
<p>To list all available Krylov methods, run the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">list_krylov_methods</span><span class="p">()</span>
</pre></div>
</div>
<p>To list all available preconditioners, run the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">list_preconditioners</span><span class="p">()</span>
</pre></div>
</div>
<p>To list all available solver methods, including LU methods, Krylov
methods and, possibly, other methods, run the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">list_solver_methods</span><span class="p">()</span>
</pre></div>
</div>
<p><em>2. Solving linear variational problems</em></p>
<p>A linear variational problem a(u, v) = L(v) for all v may be
solved by calling solve(a == L, u, ...), where a is a bilinear
form, L is a linear form, u is a Function (the solution). Optional
arguments may be supplied to specify boundary conditions or solver
parameters. Some examples are given below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="n">bc</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="p">[</span><span class="n">bc1</span><span class="p">,</span> <span class="n">bc2</span><span class="p">])</span>

<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="n">bcs</span><span class="p">,</span>
      <span class="n">solver_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linear_solver&quot;</span><span class="p">:</span> <span class="s2">&quot;lu&quot;</span><span class="p">},</span>
      <span class="n">form_compiler_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;optimize&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</pre></div>
</div>
<p>For available choices for the &#8216;solver_parameters&#8217; kwarg, look at:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">info</span><span class="p">(</span><span class="n">LinearVariationalSolver</span><span class="o">.</span><span class="n">default_parameters</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><em>3. Solving nonlinear variational problems</em></p>
<p>A nonlinear variational problem F(u; v) = 0 for all v may be
solved by calling solve(F == 0, u, ...), where the residual F is a
linear form (linear in the test function v but possibly nonlinear
in the unknown u) and u is a Function (the solution). Optional
arguments may be supplied to specify boundary conditions, the
Jacobian form or solver parameters. If the Jacobian is not
supplied, it will be computed by automatic differentiation of the
residual form. Some examples are given below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">F</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">F</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="n">bc</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">F</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="p">[</span><span class="n">bc1</span><span class="p">,</span> <span class="n">bc2</span><span class="p">])</span>

<span class="n">solve</span><span class="p">(</span><span class="n">F</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span>
      <span class="n">solver_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linear_solver&quot;</span><span class="p">:</span> <span class="s2">&quot;lu&quot;</span><span class="p">},</span>
      <span class="n">form_compiler_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;optimize&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</pre></div>
</div>
<p>For available choices for the &#8216;solver_parameters&#8217; kwarg, look at:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>info(NonlinearVariationalSolver.default_parameters(), 1)</p>
</div></blockquote>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>4. Solving linear/nonlinear variational problems adaptively</p>
<p>Linear and nonlinear variational problems maybe solved adaptively,
with automated goal-oriented error control. The automated error
control algorithm is based on adaptive mesh refinement in
combination with automated generation of dual-weighted
residual-based error estimates and error indicators.</p>
<p>An adaptive solve may be invoked by giving two additional
arguments to the solve call, a numerical error tolerance and a
goal functional (a Form).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">u</span><span class="o">*</span><span class="n">dx</span><span class="p">()</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.e-6</span>

<span class="c1"># Linear variational problem</span>
<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="n">bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>

<span class="c1"># Nonlinear problem:</span>
<span class="n">solve</span><span class="p">(</span><span class="n">F</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="n">bc</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../variationalproblem/index.html" class="btn btn-neutral float-right" title="dolfin.fem.variationalproblem module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="NonlinearVariationalSolver.html" class="btn btn-neutral" title="NonlinearVariationalSolver" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright FEniCS Project, https://fenicsproject.org.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>