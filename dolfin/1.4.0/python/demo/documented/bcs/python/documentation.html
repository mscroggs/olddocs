

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Set boundary conditions for meshes that include boundary indicators &mdash; FEniCS Project</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="FEniCS Project" href="../../../../index.html"/>
        <link rel="up" title="Collection of documented demos" href="../../../index.html"/>
        <link rel="next" title="3. Biharmonic equation" href="../../biharmonic/python/documentation.html"/>
        <link rel="prev" title="1. Auto adaptive Poisson equation" href="../../auto-adaptive-poisson/python/documentation.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> DOLFIN
          

          
          </a>

          
            
            
              <div class="version">
                1.4.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../programmers-reference/index.html">Programmer&#8217;s reference for DOLFIN (Python)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Collection of documented demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../auto-adaptive-poisson/python/documentation.html">1. Auto adaptive Poisson equation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. Set boundary conditions for meshes that include boundary indicators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#equation-and-the-problem-definition">2.1. Equation and the problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation">2.2. Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complete-code">2.3. Complete code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../biharmonic/python/documentation.html">3. Biharmonic equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../built-in_meshes/python/documentation.html">4. Built-in meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cahn-hilliard/python/documentation.html">5. Cahn-Hilliard equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../csg-2D/python/documentation.html">6. Create CSG 2D-geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../csg-3D/python/documentation.html">7. Create CSG 3D-geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../eigenvalue/python/documentation.html">8. A simple eigenvalue solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hyperelasticity/python/documentation.html">9. Hyperelasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mesh-generation/python/documentation.html">10. Generate mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mixed-poisson-dual/python/documentation.html">11. Dual-mixed formulation for Poisson equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mixed-poisson/python/documentation.html">12. Mixed formulation for Poisson equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../navier-stokes/python/documentation.html">13. Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../neumann-poisson/python/documentation.html">14. Poisson equation with pure Neumann boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nonlinear-poisson/python/documentation.html">15. Nonlinear Poisson equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../periodic/python/documentation.html">16. Poisson equation with periodic boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../poisson/python/documentation.html">17. Poisson equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../singular-poisson/python/documentation.html">18. Singular Poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stokes-iterative/python/documentation.html">19. Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stokes-mini/python/documentation.html">20. Stokes equations with Mini elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stokes-stabilized/python/documentation.html">21. Stokes equations with stabilized first order elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stokes-taylor-hood/python/documentation.html">22. Stokes equations with Taylor-Hood elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subdomains-poisson/python/documentation.html">23. Poisson equation with multiple subdomains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subdomains/python/documentation.html">24. Marking subdomains of a mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor-weighted-poisson/python/documentation.html">25. Tensor-weighted Poisson</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick_reference.html">Quick Programmer&#8217;s Reference (Python)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">DOLFIN</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">Collection of documented demos</a> &raquo;</li>
      
    <li>2. Set boundary conditions for meshes that include boundary indicators</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/demo/documented/bcs/python/documentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="set-boundary-conditions-for-meshes-that-include-boundary-indicators">
<span id="demo-pde-bcs-documentation"></span><h1>2. Set boundary conditions for meshes that include boundary indicators<a class="headerlink" href="#set-boundary-conditions-for-meshes-that-include-boundary-indicators" title="Permalink to this headline">¶</a></h1>
<p>This demo is implemented in a single python file, <a class="reference download internal" href="../../../../_downloads/demo_bcs.py" download=""><code class="xref download docutils literal"><span class="pre">demo_bcs.py</span></code></a>,
which contains both the variational form and the solver.</p>
<p>This demo illustrates how to:</p>
<ul class="simple">
<li>Use meshes with boundary indicators</li>
<li>Solve the Poisson equation with Dirichlet boundary values</li>
</ul>
<p>The solution for <span class="math">\(u\)</span> in this demo will look as follows:</p>
<a class="reference internal image-reference" href="../../../../_images/demo_bcs.png"><img alt="../../../../_images/demo_bcs.png" src="../../../../_images/demo_bcs.png" style="width: 960.0px; height: 582.0px;" /></a>
<div class="section" id="equation-and-the-problem-definition">
<h2>2.1. Equation and the problem definition<a class="headerlink" href="#equation-and-the-problem-definition" title="Permalink to this headline">¶</a></h2>
<p>We will use the Poisson equation as a model problem when we demonstrate
how to set boundary conditions for an imported mesh that includes boundary indicators.
The Poisson equation is the canonical elliptic partial differential equation.
For a domain <span class="math">\(\Omega \subset \mathbb{R}^3\)</span> with boundary <span class="math">\(\partial \Omega = \cup_{i = 0}^3 \Gamma_{D, i}\)</span>,
the Poisson equation with particular boundary conditions reads:</p>
<div class="math">
\[\begin{split}- \nabla^{2} u &amp;= f \quad {\rm in} \ \Omega, \\
     u &amp;= u_0 \quad {\rm on} \ \Gamma_{D, 0}, \\
     u &amp;= u_1 \quad {\rm on} \ \Gamma_{D, 1}, \\
     u &amp;= u_2 \quad {\rm on} \ \Gamma_{D, 2}, \\
     u &amp;= u_3 \quad {\rm on} \ \Gamma_{D, 3}. \\\end{split}\]</div>
<p>Here, <span class="math">\(f\)</span> is some given input data and <span class="math">\(u_0\)</span>, <span class="math">\(u_1\)</span>, <span class="math">\(u_2\)</span> and <span class="math">\(u_3\)</span>
are the prescribed values of <span class="math">\(u\)</span> at the boundaries.
The variational form of the Poisson equation reads: find <span class="math">\(u \in V\)</span> such that</p>
<div class="math">
\[a(u, v) = L(v) \quad \forall \ v \in V,\]</div>
<p>where <span class="math">\(V\)</span> is a suitable function space and</p>
<div class="math">
\[\begin{split}a(u, v) &amp;= \int_{\Omega} \nabla u \cdot \nabla v \, {\rm d} x, \\
L(v)    &amp;= \int_{\Omega} f v \, {\rm d} x.\end{split}\]</div>
<p>The expression <span class="math">\(a(u, v)\)</span> is the bilinear form and <span class="math">\(L(v)\)</span> is the linear form.
It is assumed that all functions in <span class="math">\(V\)</span> satisfy the Dirichlet boundary conditions.</p>
<p>In this demo we shall consider the domain <span class="math">\(\Omega\)</span> to be a model
of blood vessels with an aneurysm.  It has one inlet vessel and two
outlet vessels.  We define noslip boundary conditions on the walls of
the vessels and aneurysm, that is <span class="math">\(u = u_0 = 0.0\)</span>.  We let
<span class="math">\(u = u_1 = 1.0\)</span> be the Dirichlet condition on the inlet, the
outlets will have the prescribed values <span class="math">\(u = u_2 = 2.0\)</span> and
<span class="math">\(u = u_3 = 3.0\)</span>.  In summary, we have:</p>
<ul class="simple">
<li><span class="math">\(u = u_0 = 0.0 \text{ on } \Gamma_{D, 0}\)</span>  (noslip boundary)</li>
<li><span class="math">\(u = u_1 = 1.0 \text{ on } \Gamma_{D, 1}\)</span>  (inlet)</li>
<li><span class="math">\(u = u_2 = 2.0 \text{ on } \Gamma_{D, 2}\)</span>  (outlet 1)</li>
<li><span class="math">\(u = u_3 = 3.0 \text{ on } \Gamma_{D, 3}\)</span>  (outlet 2)</li>
<li><span class="math">\(f = 0.0\)</span>  (source term)</li>
</ul>
</div>
<div class="section" id="implementation">
<h2>2.2. Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>This description goes through the implementation (in
<a class="reference download internal" href="../../../../_downloads/demo_bcs.py" download=""><code class="xref download docutils literal"><span class="pre">demo_bcs.py</span></code></a>) of a solver for the above described Poisson
equation and how to set boundary conditions for a mesh that includes
boundary indicators.</p>
<p>First, the <a class="reference internal" href="../../../../programmers-reference/index.html#module-dolfin" title="dolfin"><code class="xref py py-mod docutils literal"><span class="pre">dolfin</span></code></a> module is imported:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Then, we import the mesh and create a finite element function space
<span class="math">\(V\)</span> relative to this mesh. In this case we create a
<a class="reference internal" href="../../../../programmers-reference/functions/functionspace/FunctionSpace.html#dolfin.functions.functionspace.FunctionSpace" title="dolfin.functions.functionspace.FunctionSpace"><code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code></a>
<code class="docutils literal"><span class="pre">V</span></code> consisting of continuous piecewise linear polynomials.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Create mesh and define function space</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../aneurysm.xml.gz&quot;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we define the trial function u and the test function v, both living in the function space <code class="docutils literal"><span class="pre">V</span></code>. We also define our variational problem, a and L. u and v are defined using the classes
<a class="reference internal" href="../../../../programmers-reference/functions/function/TrialFunction.html#dolfin.functions.function.TrialFunction" title="dolfin.functions.function.TrialFunction"><code class="xref py py-class docutils literal"><span class="pre">TrialFunction</span></code></a> and
<a class="reference internal" href="../../../../programmers-reference/functions/function/TrialFunction.html#dolfin.functions.function.TrialFunction" title="dolfin.functions.function.TrialFunction"><code class="xref py py-class docutils literal"><span class="pre">TestFunction</span></code></a>,
respetively, on the <a class="reference internal" href="../../../../programmers-reference/functions/functionspace/FunctionSpace.html#dolfin.functions.functionspace.FunctionSpace" title="dolfin.functions.functionspace.FunctionSpace"><code class="xref py py-class docutils literal"><span class="pre">FunctionSpace</span></code></a> <code class="docutils literal"><span class="pre">V</span></code>.
The source <span class="math">\(f\)</span> may be defined as a <a class="reference internal" href="../../../../programmers-reference/functions/constant/Constant.html#dolfin.functions.constant.Constant" title="dolfin.functions.constant.Constant"><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code></a>.
The bilinear and linear forms, <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">L</span></code> respectively, are defined using UFL operators.
Thus, the definition of the variational problem reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Define variational problem</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dx</span>
</pre></div>
</div>
<p>Before we can solve the problem we must specify the boundary conditions.
We begin with specifying the values of the boundary conditions as <code class="xref py py-class docutils literal"><span class="pre">Constant</span></code> to define the Dirichlet boundary conditions:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Define boundary condition values</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c1"># Define boundary conditions</span>
<span class="n">bc0</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">bc1</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bc2</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bc3</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="../../../../programmers-reference/fem/bcs/DirichletBC.html#dolfin.fem.bcs.DirichletBC" title="dolfin.fem.bcs.DirichletBC"><code class="xref py py-class docutils literal"><span class="pre">DirichletBC</span></code></a> takes three arguments, the first one is our function space <code class="docutils literal"><span class="pre">V</span></code>,
the next is the boundary condition value and the third is the subdomain indicator which is information stored in the mesh.</p>
<p>At this point we are ready to create a <a class="reference internal" href="../../../../programmers-reference/cpp/function/Function.html#dolfin.cpp.function.Function" title="dolfin.cpp.function.Function"><code class="xref py py-class docutils literal"><span class="pre">Function</span></code></a> <code class="docutils literal"><span class="pre">u</span></code> to store the solution and call the solve function with the arguments
<code class="docutils literal"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">L</span></code>, <code class="docutils literal"><span class="pre">u</span></code>, <code class="docutils literal"><span class="pre">[bc0,</span> <span class="pre">bc1,</span> <span class="pre">bc2,</span> <span class="pre">bc3]</span></code>, as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Compute solution</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="p">[</span><span class="n">bc0</span><span class="p">,</span> <span class="n">bc1</span><span class="p">,</span> <span class="n">bc2</span><span class="p">,</span> <span class="n">bc3</span><span class="p">])</span>
</pre></div>
</div>
<p>When we have solved the problem, we save the solution to file and plot it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Write solution to file</span>
<span class="n">File</span><span class="p">(</span><span class="s2">&quot;u.pvd&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">u</span>

<span class="c1"># Plot solution</span>
<span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="complete-code">
<h2>2.3. Complete code<a class="headerlink" href="#complete-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">dolfin</span> <span class="k">import</span> <span class="o">*</span>

<span class="c1"># Create mesh and define function space</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../aneurysm.xml.gz&quot;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Define variational problem</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dx</span>

<span class="c1"># Define boundary condition values</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c1"># Define boundary conditions</span>
<span class="n">bc0</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">bc1</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bc2</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bc3</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">u3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Set PETSc MUMPS paramter (this is required to prevent a memory error</span>
<span class="c1"># in some cases when using MUMPS LU solver).</span>
<span class="k">if</span> <span class="n">has_petsc</span><span class="p">():</span>
    <span class="n">PETScOptions</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;mat_mumps_icntl_14&quot;</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)</span>

<span class="c1"># Compute solution</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="p">[</span><span class="n">bc0</span><span class="p">,</span> <span class="n">bc1</span><span class="p">,</span> <span class="n">bc2</span><span class="p">,</span> <span class="n">bc3</span><span class="p">])</span>

<span class="c1"># Write solution to file</span>
<span class="n">File</span><span class="p">(</span><span class="s2">&quot;u.pvd&quot;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">u</span>

<span class="c1"># Plot solution</span>
<span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../biharmonic/python/documentation.html" class="btn btn-neutral float-right" title="3. Biharmonic equation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../auto-adaptive-poisson/python/documentation.html" class="btn btn-neutral" title="1. Auto adaptive Poisson equation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright FEniCS Project, https://fenicsproject.org.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>